- hosts: localhost
  connection: local
  become: true

  vars:
    service_name: http-demo
    service_version: v1.0.3
    service_dir: "/home/ubuntu/{{ service_name }}"
    artifactUrl: https://maven.pkg.github.com/rmortale/camel-http-demo/ch/dulce/http-demo/{{ service_version }}/http-demo-{{ service_version }}-runner.jar
    maven_user: rmortale
    maven_pw: !vault |
          $ANSIBLE_VAULT;1.1;AES256
          33653836353232626634653231386263306663336163663032623863306430363836356437323562
          3830346132343862626539303562313239373432383166310a376661613836653434623830653032
          62373730633336366538333932613330363635393136356530343066376466316138643666646333
          3166333731353237640a373736386665346235623832393466353562313630343638336138663630
          62303766623432323035386636666564656138353034383162613661616432366230306637616436
          6538386566376235653762323136396237666632393039373161 

  pre_tasks:
    - name: ensure apt cache is up to date
      apt:
        update_cache: true
      changed_when: false

  tasks:
    - include_tasks: tasks/packages.yml
    - include_tasks: tasks/cron.yml
    - include_tasks: tasks/microservice.yml
  
